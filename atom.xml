<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>xmq blogs</title>
  
  <subtitle>害怕却又向往</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-06-01T13:42:28.012Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>xmq</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>整理数据的各种问题</title>
    <link href="http://yoursite.com/2018/06/01/%E6%95%B4%E7%90%86%E6%95%B0%E6%8D%AE%E7%9A%84%E5%90%84%E7%A7%8D%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2018/06/01/整理数据的各种问题/</id>
    <published>2018-06-01T13:00:40.000Z</published>
    <updated>2018-06-01T13:42:28.012Z</updated>
    
    <content type="html"><![CDATA[<p>三天理数据，训练两小时。</p><p>最近一直在整理各种各样的数据，从甲方发过来的数据一般都特别乱，甚至自带的标注都不能用，愁。</p><h1 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h1><p>图片名中有中文：需要重新对图片进行排序。</p><h3 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h3><p>代码(python3)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">img = cv2.imread(<span class="string">'浙TF2ULF_203062.jpg'</span>)</span><br><span class="line">hue_image = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)</span><br></pre></td></tr></table></figure><p>错误报告</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OpenCV(3.4.1) Error: Assertion failed ((scn == 3 || scn == 4) &amp;&amp; (depth == 0 || depth == 5)) in cv::cvtColor, file D:\Build\OpenCV\opencv-3.4.1\modules\imgproc\src\color.cpp, line 11214</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;1.py&quot;, line 5, in &lt;module&gt;</span><br><span class="line">    hue_image = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)</span><br><span class="line">cv2.error: OpenCV(3.4.1) D:\Build\OpenCV\opencv-3.4.1\modules\imgproc\src\color.cpp:11214: error: (-215) (scn == 3 || scn == 4) &amp;&amp; (depth == 0 || depth == 5) in function cv::cvtColor</span><br></pre></td></tr></table></figure><p>去掉“浙”字重新命名即可</p><h1 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h1><p>从网上爬来的、排序得到的图片有的时候是损坏的，需要判断图片是否是有效图片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_valid_image</span><span class="params">(filename)</span>:</span></span><br><span class="line">    valid = <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        Image.open(filename).load()</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        valid = <span class="keyword">False</span></span><br><span class="line">    <span class="keyword">return</span> valid</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'result.txt'</span>,<span class="string">'w'</span>)</span><br><span class="line">flag = is_valid_image(list)</span><br><span class="line">print(flag)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">f.write(<span class="string">'not valid image'</span>+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    do something</span><br></pre></td></tr></table></figure><p><em>待续</em></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;三天理数据，训练两小时。&lt;/p&gt;
&lt;p&gt;最近一直在整理各种各样的数据，从甲方发过来的数据一般都特别乱，甚至自带的标注都不能用，愁。&lt;/p&gt;
&lt;h1 id=&quot;问题1&quot;&gt;&lt;a href=&quot;#问题1&quot; class=&quot;headerlink&quot; title=&quot;问题1&quot;&gt;&lt;/a&gt;问题1&lt;
      
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu安装CUDA、CUDNN</title>
    <link href="http://yoursite.com/2018/05/21/Ubuntu%E5%AE%89%E8%A3%85CUDA%E3%80%81CUDNN/"/>
    <id>http://yoursite.com/2018/05/21/Ubuntu安装CUDA、CUDNN/</id>
    <published>2018-05-21T12:30:11.000Z</published>
    <updated>2018-06-01T13:31:19.603Z</updated>
    
    <content type="html"><![CDATA[<p><strong><em>适用于多用户服务器安装于自己目录的情况</em></strong></p><p><em>因为安装好Anaconda之后其实已经自带了CUDA、CUDNN这些，但是我发现实际配置caffe还是会有各种各样的问题，所以重新自己安装了</em></p><h1 id="CUDA"><a href="#CUDA" class="headerlink" title="CUDA"></a>CUDA</h1><p>首先在<a href="https://developer.nvidia.com/cuda-toolkit-archive" target="_blank" rel="noopener">官网</a>下载需要的CUDA版本的安装包，以CUDA9.0版本为例，选择后会引导一步步地选择合适的版本，我的选择如下图：</p><p><img src="https://upload-images.jianshu.io/upload_images/12286585-0703ee25c2e76cce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1"></p><p>即可开始下载cuda_9.0.176_384.81_linux.run </p><p>下载好后，安装CUDA</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x cuda_9.0.176_384.81_linux.run</span><br><span class="line">./cuda_9.0.176_384.81_linux.run</span><br></pre></td></tr></table></figure><p>添加环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi  ~/.bashrc</span><br><span class="line">export PATH=&quot;/yourpath/cuda-9.0/bin:$PATH&quot;</span><br><span class="line">export LD_LIBRARY_PATH=/yourpath/cuda-9.0/lib64</span><br><span class="line"></span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>查看自己现在安装的CUDA版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -V</span><br></pre></td></tr></table></figure><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="找不到nvcc"><a href="#找不到nvcc" class="headerlink" title="找不到nvcc"></a>找不到nvcc</h3><p>原因是环境路径未设置，设置PATH和LD_LIBRARY_PATH</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PATH=&quot;/yourpath/cuda-9.0/bin:$PATH&quot;</span><br><span class="line">export LD_LIBRARY_PATH=/yourpath/cuda-9.0/lib64</span><br></pre></td></tr></table></figure><h1 id="cuDNN"><a href="#cuDNN" class="headerlink" title="cuDNN"></a>cuDNN</h1><p>需要根据上一步安装的CUDA版本来下载对应的cuDNN安装包，这里我下载了cudnn-9.0-linux-x64-v7.1.tgz </p><p>解压文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar xvf cudnn-9.0-linux-x64-v7.1.tgz</span><br></pre></td></tr></table></figure><p>得到一个cuda文件夹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd cuda</span><br><span class="line">cp include/cudnn.h /yourpath/cuda-9.0/include/</span><br><span class="line">cp lib64/libcudnn* /yourpath/cuda-9.0/lib64/</span><br><span class="line">chmod a+r /yourpath/cuda-9.0/include/cudnn.h /yourpath/cuda-9.0/lib64/libcudnn*</span><br></pre></td></tr></table></figure><p>查看cuDNN版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /yourpath/cuda-9.0/include/cudnn.h |grep CUDNN_MAJOR -A 2</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#define CUDNN_MAJOR 7</span><br><span class="line">#define CUDNN_MINOR 1</span><br><span class="line">#define CUDNN_PATCHLEVEL 1</span><br><span class="line">--</span><br><span class="line">#define CUDNN_VERSION    (CUDNN_MAJOR * 1000 + CUDNN_MINOR * 100 + CUDNN_PATCHLEVEL)</span><br><span class="line"></span><br><span class="line">#include &quot;driver_types.h&quot;</span><br></pre></td></tr></table></figure><p>可知cuDNN版本为7.1.1</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;&lt;em&gt;适用于多用户服务器安装于自己目录的情况&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;因为安装好Anaconda之后其实已经自带了CUDA、CUDNN这些，但是我发现实际配置caffe还是会有各种各样的问题，所以重新自己安装了&lt;/em&gt;&lt;/p&gt;

      
    
    </summary>
    
      <category term="教程" scheme="http://yoursite.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu安装Anaconda和Tensorflow(GPU版)、opencv3 with contrib</title>
    <link href="http://yoursite.com/2018/05/21/Anaconda%20%E5%AE%89%E8%A3%85python%20opencv/"/>
    <id>http://yoursite.com/2018/05/21/Anaconda 安装python opencv/</id>
    <published>2018-05-20T17:20:23.188Z</published>
    <updated>2018-06-01T13:15:44.157Z</updated>
    
    <content type="html"><![CDATA[<p><strong><em>适用于服务器上多用户安装于自己目录的情况</em></strong></p><h1 id="Anaconda"><a href="#Anaconda" class="headerlink" title="Anaconda"></a>Anaconda</h1><p>首先在<a href="https://repo.continuum.io/archive/" target="_blank" rel="noopener">官网</a>下载对应的Anaconda的安装包,此处我选择Anaconda3-5.1.0-Linux-x86_64.sh，对应python3.6</p><pre><code>bash Anaconda3-5.1.0-Linux-x86_64.sh./Anaconda3-5.1.0-Linux-x86_64.sh</code></pre><p>安装好Anaconda后，可以检查下python版本</p><pre><code>python -v</code></pre><p>安装好的Anaconda里面带有自带的spyder，服务器上用xshell带有图形界面</p><p>为了加速下载将软件的源修改为ustc的源</p><pre><code>conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/free/conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/main/conda config --set show_channel_urls yes</code></pre><h1 id="Tensorflow"><a href="#Tensorflow" class="headerlink" title="Tensorflow"></a>Tensorflow</h1><p>然后通过Anaconda来安装GPU版本的tensorflow，安装的同时会自动安装CUDA，CUDNN等库</p><pre><code>conda install tensorflow-gpu</code></pre><p>配置环境变量</p><pre><code>source .bashrc</code></pre><h1 id="Opencv3-with-contrib"><a href="#Opencv3-with-contrib" class="headerlink" title="Opencv3 with contrib"></a>Opencv3 with contrib</h1><p>安装带有contrib包的opencv3</p><pre><code>pip install opencv-contrib-python</code></pre><p>查看python下opencv的版本</p><pre><code>pythonimport cv2cv2.__version__</code></pre><p>​    </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;&lt;em&gt;适用于服务器上多用户安装于自己目录的情况&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;Anaconda&quot;&gt;&lt;a href=&quot;#Anaconda&quot; class=&quot;headerlink&quot; title=&quot;Anaconda&quot;&gt;&lt;/a&gt;Anaconda
      
    
    </summary>
    
      <category term="教程" scheme="http://yoursite.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
  </entry>
  
</feed>
